<!DOCTYPE html>
<html>
<head>
    <title>My Custom Google Map</title>
    <style>
        #map {
            height: 600px;
            width: 100%;
        }
        .controls {
            margin: 10px;
            padding: 10px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div class="controls">
        <input type="text" id="location" placeholder="Enter location name">
        <input type="text" id="lat" placeholder="Latitude">
        <input type="text" id="lng" placeholder="Longitude">
        <button onclick="addMarker()">Add Pin</button>
        <button onclick="clearMarkers()">Clear All Pins</button>
    </div>
    <div id="map"></div>

    <script>
        let map;
        let markers = [];

        // Initialize the map
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 2,
                center: { lat: 0, lng: 0 },
            });

            // Add click listener to map
            map.addListener('click', function(event) {
                document.getElementById('lat').value = event.latLng.lat();
                document.getElementById('lng').value = event.latLng.lng();
            });
        }

        // Add a new marker
        function addMarker() {
            const location = document.getElementById('location').value;
            const lat = parseFloat(document.getElementById('lat').value);
            const lng = parseFloat(document.getElementById('lng').value);

            if (isNaN(lat) || isNaN(lng)) {
                alert('Please enter valid coordinates');
                return;
            }

            const marker = new google.maps.Marker({
                position: { lat, lng },
                map: map,
                title: location
            });

            // Add info window
            const infoWindow = new google.maps.InfoWindow({
                content: `<h3>${location}</h3><p>Latitude: ${lat}<br>Longitude: ${lng}</p>`
            });

            marker.addListener('click', () => {
                infoWindow.open(map, marker);
            });

            markers.push(marker);
            
            // Clear input fields
            document.getElementById('location').value = '';
            document.getElementById('lat').value = '';
            document.getElementById('lng').value = '';
        }

        // Clear all markers
        function clearMarkers() {
            markers.forEach(marker => marker.setMap(null));
            markers = [];
        }

        // Save markers to localStorage
        function saveMarkers() {
            const markerData = markers.map(marker => ({
                position: marker.getPosition().toJSON(),
                title: marker.getTitle()
            }));
            localStorage.setItem('mapMarkers', JSON.stringify(markerData));
        }

        // Load markers from localStorage
        function loadMarkers() {
            const savedMarkers = localStorage.getItem('mapMarkers');
            if (savedMarkers) {
                JSON.parse(savedMarkers).forEach(markerData => {
                    const marker = new google.maps.Marker({
                        position: markerData.position,
                        map: map,
                        title: markerData.title
                    });
                    markers.push(marker);
                });
            }
        }
    </script>
    <script async
        src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap">
    </script>
</body>
</html>
